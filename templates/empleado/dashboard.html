{% extends 'base.html' %}
{% load static %}

{% block title %}Panel de Empleado - Bullburger{% endblock %}

{% block content %}
<!-- Cargar el CSS externo -->
<link rel="stylesheet" href="{% static 'css/empleado_style.css' %}">

<div class="welcome-container">
  <!-- ğŸ”¹ Bloque con estadÃ­sticas en tiempo real -->
  <div class="welcome-header">
    <h1>Â¡Panel de Empleado!</h1>
    <p>Hola, <strong>{{ user.nombre }}</strong>. Estado actual de los pedidos</p>
    
    <!-- EstadÃ­sticas en tiempo real -->
    <div class="stats-grid">
      <div class="stat-card stat-total">
        <div class="stat-number" id="total-pedidos">{{ total_pedidos }}</div>
        <div class="stat-label">Total Pedidos Hoy</div>
      </div>
      
      <div class="stat-card stat-pendiente">
        <div class="stat-number" id="pedidos-pendientes">{{ pedidos_pendientes.count }}</div>
        <div class="stat-label">Pendientes</div>
      </div>
      
      <div class="stat-card stat-preparando">
        <div class="stat-number" id="pedidos-preparando">{{ pedidos_preparando.count }}</div>
        <div class="stat-label">En PreparaciÃ³n</div>
      </div>
      
      <div class="stat-card stat-listo">
        <div class="stat-number" id="pedidos-listos">{{ pedidos_listos.count }}</div>
        <div class="stat-label">Listos para Entregar</div>
      </div>
    </div>


  <!-- Tarjetas de funcionalidades -->
  <div class="feature-grid">
    <!-- Tomar Pedidos -->
    <div class="feature-card">
      <div class="circle-icon">
        <span style="font-size: 2rem;">ğŸ”</span>
      </div>
      <h3>Tomar Pedidos</h3>
      <p>Registrar nuevos pedidos de clientes</p>
      <button class="btn btn-primary" onclick="window.location.href='#'">Nuevo Pedido</button>
    </div>

    <!-- Gestionar Pedidos -->
    <div class="feature-card">
      <div class="circle-icon">
        <span style="font-size: 2rem;">ğŸ“‹</span>
      </div>
      <h3>Gestionar Pedidos</h3>
      <p>Ver y gestionar pedidos en curso</p>
      <button class="btn btn-primary" onclick="window.location.href='{% url 'gestion_pedidos' %}'">Ver Pedidos</button>
    </div>

    <!-- Inventario -->
    <div class="feature-card">
      <div class="circle-icon">
        <span style="font-size: 2rem;">ğŸ“¦</span>
      </div>
      <h3>Inventario</h3>
      <p>Revisar y gestionar stock</p>
      <button class="btn btn-primary" onclick="window.location.href='{% url 'inventario' %}'">Ver Inventario</button>
    </div>
  </div>
</div>

<script>
// FunciÃ³n para actualizar estadÃ­sticas en tiempo real
function actualizarEstadisticas() {
    fetch('/empleado/api/estadisticas/')
        .then(response => response.json())
        .then(data => {
            document.getElementById('total-pedidos').textContent = data.total_pedidos;
            document.getElementById('pedidos-pendientes').textContent = data.pedidos_pendientes;
            document.getElementById('pedidos-preparando').textContent = data.pedidos_preparando;
            document.getElementById('pedidos-listos').textContent = data.pedidos_listos;
            
            const now = new Date();
            document.getElementById('last-updated-time').textContent = 
                now.getHours().toString().padStart(2, '0') + ':' + 
                now.getMinutes().toString().padStart(2, '0') + ':' + 
                now.getSeconds().toString().padStart(2, '0');
        })
        .catch(error => {
            console.error('Error actualizando estadÃ­sticas:', error);
        });
}

// Actualizar automÃ¡ticamente cada 30 segundos
setInterval(actualizarEstadisticas, 30000);
</script>
{% endblock %}