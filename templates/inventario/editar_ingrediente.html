{% extends 'base.html' %}
{% load static %}

{% block title %}Editar Ingrediente - BullBurger{% endblock %}

{% block content %}
<div class="inventario-dashboard">
    <!-- Header del Inventario -->
    <div class="dashboard-header">
        <h1 class="welcome-title">Editar Ingrediente - BullBurger</h1>
        <p class="welcome-subtitle">Modifica la información del ingrediente</p>
    </div>

    <div class="form-container">
        <div class="form-card">
            <form method="post" onsubmit="return validateIngredienteForm(event)">
                {% csrf_token %}
                
                <div class="form-group">
                    <label for="nombre">Nombre del Ingrediente *</label>
                    <input type="text" id="nombre" name="nombre" value="{{ ingrediente.nombre }}" required 
                           placeholder="Ej: Carne de res, Pan hamburguesa, Queso americano">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="unidad_medida">Unidad de Medida *</label>
                        <select id="unidad_medida" name="unidad_medida" required>
                            <option value="">Selecciona unidad</option>
                            <option value="kg" {% if ingrediente.unidad_medida == 'kg' %}selected{% endif %}>Kilogramos (kg)</option>
                            <option value="g" {% if ingrediente.unidad_medida == 'g' %}selected{% endif %}>Gramos (g)</option>
                            <option value="l" {% if ingrediente.unidad_medida == 'l' %}selected{% endif %}>Litros (l)</option>
                            <option value="ml" {% if ingrediente.unidad_medida == 'ml' %}selected{% endif %}>Mililitros (ml)</option>
                            <option value="unidad" {% if ingrediente.unidad_medida == 'unidad' %}selected{% endif %}>Unidades</option>
                            <option value="lb" {% if ingrediente.unidad_medida == 'lb' %}selected{% endif %}>Libras (lb)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="costo_unitario">Costo Unitario ($) *</label>
                        <input type="number" id="costo_unitario" name="costo_unitario" 
                               value="{{ ingrediente.costo_unitario }}" step="0.01" min="0" required placeholder="0.00">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="stock_actual">Stock Actual *</label>
                        <input type="number" id="stock_actual" name="stock_actual" 
                               value="{{ ingrediente.stock_actual }}" step="0.01" min="0" required placeholder="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="stock_minimo">Stock Mínimo *</label>
                        <input type="number" id="stock_minimo" name="stock_minimo" 
                               value="{{ ingrediente.stock_minimo }}" step="0.01" min="0" required placeholder="10">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="proveedor">Proveedor</label>
                        <input type="text" id="proveedor" name="proveedor" 
                               value="{{ ingrediente.proveedor|default:'' }}" placeholder="Nombre del proveedor">
                    </div>
                    
                    <div class="form-group">
                        <label for="ubicacion">Ubicación</label>
                        <input type="text" id="ubicacion" name="ubicacion" 
                               value="{{ ingrediente.ubicacion|default:'' }}" placeholder="Ej: Almacén A, Refrigerador">
                    </div>
                </div>
                
                <div class="form-actions">
                    <a href="{% url 'inventario' %}" class="btn-cancel">Cancelar</a>
                    <button type="submit" class="btn-save">Actualizar Ingrediente</button>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
.form-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 2rem;
}

.form-card {
    background: white;
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
}

.form-group {
    margin-bottom: 1.5rem;
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: #2c3e50;
}

input, select {
    width: 100%;
    padding: 0.8rem;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 1rem;
    transition: border-color 0.3s ease;
}

input:focus, select:focus {
    outline: none;
    border-color: #FF6B35;
}

.form-actions {
    display: flex;
    gap: 1rem;
    justify-content: flex-end;
    margin-top: 2rem;
}

.btn-cancel, .btn-save {
    padding: 0.8rem 1.5rem;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
    text-align: center;
}

.btn-cancel {
    background: #95a5a6;
    color: white;
}

.btn-cancel:hover {
    background: #7f8c8d;
    text-decoration: none;
    color: white;
}

.btn-save {
    background: linear-gradient(135deg, #27ae60, #2ecc71);
    color: white;
}

.btn-save:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
}

@media (max-width: 768px) {
    .form-container {
        padding: 1rem;
    }
    
    .form-row {
        grid-template-columns: 1fr;
    }
    
    .form-actions {
        flex-direction: column;
    }
}
</style>

<script>
function validateIngredienteForm(event) {
    const nombre = document.getElementById('nombre');
    const stockActual = document.getElementById('stock_actual');
    const stockMinimo = document.getElementById('stock_minimo');
    const costo = document.getElementById('costo_unitario');
    
    if (!nombre.value.trim()) {
        event.preventDefault();
        alert('El nombre del ingrediente es obligatorio');
        return false;
    }
    
    if (parseFloat(stockActual.value) < 0) {
        event.preventDefault();
        alert('El stock actual no puede ser negativo');
        return false;
    }
    
    if (parseFloat(stockMinimo.value) < 0) {
        event.preventDefault();
        alert('El stock mínimo no puede ser negativo');
        return false;
    }
    
    if (parseFloat(costo.value) < 0) {
        event.preventDefault();
        alert('El costo unitario no puede ser negativo');
        return false;
    }
    
    return true;
}

// Mostrar mensajes de Django
document.addEventListener('DOMContentLoaded', function() {
    {% if messages %}
        {% for message in messages %}
            showCustomAlert('{{ message.tags|title }}', '{{ message }}');
        {% endfor %}
    {% endif %}
});

function showCustomAlert(title, message) {
    // Puedes implementar tu propio sistema de alertas o usar alert nativo
    alert(`${title}: ${message}`);
}
</script>
{% endblock %}